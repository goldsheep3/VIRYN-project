<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/init.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/init.sql" />
              <option name="originalContent" value="-- =========================&#10;-- 用户信息表：creator&#10;-- =========================&#10;DROP TABLE IF EXISTS creator;&#10;CREATE TABLE creator (&#10;        qq_id TEXT PRIMARY KEY,      -- QQ号，唯一标识用户&#10;        name TEXT NOT NULL,          -- 用户昵称，可以重复&#10;        email TEXT                   -- 用户邮箱，可选&#10;    -- 可扩展更多字段，如邮箱、头像等&#10;);&#10;&#10;-- =========================&#10;-- 事件表：event&#10;-- =========================&#10;DROP TABLE IF EXISTS event;&#10;CREATE TABLE event (&#10;        event_id TEXT PRIMARY KEY,        -- 事件唯一ID&#10;        event_type TEXT NOT NULL,         -- 类型（character/world/story）&#10;        properties TEXT,                  -- 事件属性，JSON，属性下支持last_author/PRE等&#10;            -- {&#10;            --     “属性名”: {&#10;            --         &quot;text&quot;: &quot;&quot;,        -- 字段值&#10;            --         &quot;image_ids&quot;: &quot;&quot;,   -- 图像资产id列表&#10;            --         &quot;tag_ids&quot;: &quot;&quot;,     -- 事件标签id列表&#10;            --         &quot;last_author&quot;: &quot;&quot;, -- 最近修改者（creator.qq_id）&#10;            --         &quot;last_update_time&quot;: &quot;&quot;, -- 最近更新时间，ISO格式字符串&#10;            --         &quot;PRE&quot;: {           -- PRE状态标签，可选，如下内容同上&#10;            --             &quot;text&quot;: &quot;&quot;,&#10;            --             &quot;image_ids&quot;: &quot;&quot;,&#10;            --             &quot;tag_ids&quot;: &quot;&quot;,&#10;            --             &quot;last_author&quot;: &quot;&quot;,&#10;            --         }&#10;            --     }&#10;            -- }&#10;        setting_tag_ids TEXT,             -- 设定标签ID，JSON数组字符串&#10;        upstream_story_tag_ids TEXT,      -- 上游故事标签ID，字符串&#10;        related_story_tag_ids TEXT,       -- 相关故事标签ID，JSON数组字符串&#10;        start_time TEXT,                  -- 开始时间，event_type不为story为空，否则必填&#10;        end_time TEXT,                    -- 结束时间，event_type不为story为空，否则必填&#10;        last_author TEXT,                 -- 最近修改者（creator.qq_id）&#10;        initial_author TEXT,              -- 首次创建者（creator.qq_id）&#10;        contributors TEXT,                -- 有过贡献的创作者，JSON数组字符串（qq_id列表）&#10;        created_at TEXT,                  -- 创建时间，ISO格式字符串&#10;        updated_at TEXT                   -- 最近修改时间，ISO格式字符串&#10;);&#10;&#10;-- =========================&#10;-- 图片资源表：image_asset&#10;-- =========================&#10;DROP TABLE IF EXISTS image_asset;&#10;CREATE TABLE image_asset (&#10;        image_id TEXT PRIMARY KEY,    -- 图片唯一ID&#10;        name TEXT,                   -- 图片名称&#10;        path TEXT,                   -- 图片存储路径&#10;        tags TEXT,                   -- 图片标签，JSON数组字符串&#10;        uploader TEXT,               -- 上传者qq_id&#10;        upload_time TEXT             -- 上传时间，ISO格式字符串&#10;);&#10;&#10;-- =========================&#10;-- 操作日志表：log&#10;-- =========================&#10;DROP TABLE IF EXISTS log;&#10;CREATE TABLE log (&#10;        log_id INTEGER PRIMARY KEY AUTOINCREMENT,  -- 日志自增ID&#10;        event_id TEXT,             -- 被操作的事件ID&#10;        operation TEXT,            -- 操作类型（create/update/delete/approve_pre/add_pre/reject_pre等）&#10;        operator TEXT,             -- 操作者qq_id&#10;        operate_time TEXT,         -- 操作时间，ISO格式字符串&#10;        detail TEXT                -- 操作详情，JSON字符串（如变更内容、字段名等）&#10;);&#10;&#10;-- =========================&#10;-- 事件模板表：setting_event_template&#10;-- =========================&#10;DROP TABLE IF EXISTS setting_event_template;&#10;CREATE TABLE setting_event_template (&#10;        template_id TEXT PRIMARY KEY,   -- 模板唯一ID&#10;        name TEXT NOT NULL,             -- 模板名称&#10;        description TEXT,               -- 模板描述&#10;        default_properties TEXT,        -- 默认属性，JSON结构&#10;        creator TEXT,                   -- 模板创建者qq_id&#10;        create_time TEXT                -- 创建时间，ISO格式字符串&#10;);" />
              <option name="updatedContent" value="-- =========================&#10;-- 用户信息表：creator&#10;-- =========================&#10;DROP TABLE IF EXISTS creator;&#10;CREATE TABLE creator (&#10;        qq_id TEXT PRIMARY KEY,      -- QQ号，唯一标识用户&#10;        name TEXT NOT NULL,          -- 用户昵称，可以重复&#10;        email TEXT                   -- 用户邮箱，可选&#10;    -- 可扩展更多字段，如邮箱、头像等&#10;);&#10;&#10;-- =========================&#10;-- 事件表：event&#10;-- =========================&#10;DROP TABLE IF EXISTS event;&#10;CREATE TABLE event (&#10;        event_id TEXT PRIMARY KEY,        -- 事件唯一ID&#10;        event_type TEXT NOT NULL,         -- 类型（character/world/story）&#10;        setting_tag_ids TEXT,             -- 设定标签ID，JSON数组字符串&#10;        upstream_story_tag_ids TEXT,      -- 上游故事标签ID，字符串&#10;        related_story_tag_ids TEXT,       -- 相关故事标签ID，JSON数组字符串&#10;        start_time TEXT,                  -- 开始时间，event_type不为story为空，否则必填&#10;        end_time TEXT,                    -- 结束时间，event_type不为story为空，否则必填&#10;        last_author TEXT,                 -- 最近修改者（creator.qq_id）&#10;        initial_author TEXT,              -- 首次创建者（creator.qq_id）&#10;        contributors TEXT,                -- 有过贡献的创作者，JSON数组字符串（qq_id列表）&#10;        created_at TEXT,                  -- 创建时间，ISO格式字符串&#10;        updated_at TEXT                   -- 最近修改时间，ISO格式字符串&#10;);&#10;&#10;-- =========================&#10;-- 事件属性表：event_property&#10;-- =========================&#10;DROP TABLE IF EXISTS event_property;&#10;CREATE TABLE event_property (&#10;    property_id INTEGER PRIMARY KEY AUTOINCREMENT, -- 属性唯一ID&#10;    event_id TEXT NOT NULL,                       -- 关联event表&#10;    property_name TEXT NOT NULL,                  -- 属性名&#10;    text TEXT,                                    -- 字段值&#10;    image_ids TEXT,                               -- 图像资产id列表&#10;    tag_ids TEXT,                                 -- 事件标签id列表&#10;    last_author TEXT,                             -- 最近修改者&#10;    last_update_time TEXT,                        -- 最近更新时间&#10;    pre_text TEXT,                                -- PRE状态下的text&#10;    pre_image_ids TEXT,                           -- PRE状态下的image_ids&#10;    pre_tag_ids TEXT,                             -- PRE状态下的tag_ids&#10;    pre_last_author TEXT,                         -- PRE状态下的last_author&#10;    FOREIGN KEY(event_id) REFERENCES event(event_id)&#10;);&#10;&#10;-- =========================&#10;-- 图片资源表：image_asset&#10;-- =========================&#10;DROP TABLE IF EXISTS image_asset;&#10;CREATE TABLE image_asset (&#10;        image_id TEXT PRIMARY KEY,    -- 图片唯一ID&#10;        name TEXT,                   -- 图片名称&#10;        path TEXT,                   -- 图片存储路径&#10;        tags TEXT,                   -- 图片标签，JSON数组字符串&#10;        uploader TEXT,               -- 上传者qq_id&#10;        upload_time TEXT             -- 上传时间，ISO格式字符串&#10;);&#10;&#10;-- =========================&#10;-- 操作日志表：log&#10;-- =========================&#10;DROP TABLE IF EXISTS log;&#10;CREATE TABLE log (&#10;        log_id INTEGER PRIMARY KEY AUTOINCREMENT,  -- 日志自增ID&#10;        event_id TEXT,             -- 被操作的事件ID&#10;        operation TEXT,            -- 操作类型（create/update/delete/approve_pre/add_pre/reject_pre等）&#10;        operator TEXT,             -- 操作者qq_id&#10;        operate_time TEXT,         -- 操作时间，ISO格式字符串&#10;        detail TEXT                -- 操作详情，JSON字符串（如变更内容、字段名等）&#10;);&#10;&#10;-- =========================&#10;-- 事件模板表：setting_event_template&#10;-- =========================&#10;DROP TABLE IF EXISTS setting_event_template;&#10;CREATE TABLE setting_event_template (&#10;        template_id TEXT PRIMARY KEY,   -- 模板唯一ID&#10;        name TEXT NOT NULL,             -- 模板名称&#10;        description TEXT,               -- 模板描述&#10;        default_properties TEXT,        -- 默认属性，JSON结构&#10;        creator TEXT,                   -- 模板创建者qq_id&#10;        create_time TEXT                -- 创建时间，ISO格式字符串&#10;);" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>